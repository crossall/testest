<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ëŠ˜ì˜ ë§ˆìŒ í† ë‹¥ì´ê¸°</title>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Nanum+Pen+Script&display=swap" rel="stylesheet">
    <style>
        /* --- ê¸°ë³¸ ì„¤ì • --- */
        :root {
            --primary-color: #ff9a9e;
            --secondary-color: #fecfef;
            --bg-gradient: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-color: #4a4a4a;
            --accent-color: #ff6b6b;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Gowun Dodum', sans-serif;
            background-image: linear-gradient(to top, #fff1eb 0%, #ace0f9 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-color);
            padding: 20px;
        }

        /* --- ì»¨í…Œì´ë„ˆ ë””ìì¸ --- */
        .container {
            background-color: var(--card-bg);
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            padding: 40px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        h1 {
            font-family: 'Gowun Dodum', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #555;
        }

        .subtitle {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 30px;
        }

        /* --- API í‚¤ ì…ë ¥ (ìƒë‹¨ ìˆ¨ê¹€/ë…¸ì¶œ) --- */
        .api-section {
            margin-bottom: 20px;
            text-align: left;
            font-size: 0.8rem;
        }
        .api-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-top: 5px;
            font-family: sans-serif;
        }

        /* --- ê¸°ëŠ¥ 1: ê°ì • ì„ íƒ --- */
        .emotion-section {
            margin-bottom: 30px;
        }
        .emotion-label {
            display: block;
            margin-bottom: 15px;
            font-weight: bold;
            color: #666;
        }
        .emotions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .emotion-btn {
            background: none;
            border: 2px solid transparent;
            font-size: 2rem;
            cursor: pointer;
            transition: transform 0.2s, filter 0.2s;
            border-radius: 50%;
            padding: 5px;
        }
        .emotion-btn:hover {
            transform: scale(1.2);
        }
        .emotion-btn.selected {
            background-color: #fff0f0;
            border-color: var(--accent-color);
            transform: scale(1.1);
        }

        /* --- ê¸°ëŠ¥ 2: í•œì¤„ ì…ë ¥ --- */
        .input-section {
            margin-bottom: 30px;
        }
        textarea {
            width: 100%;
            height: 100px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            resize: none;
            font-family: 'Gowun Dodum', sans-serif;
            font-size: 1rem;
            background-color: #f9f9f9;
            transition: border-color 0.3s;
        }
        textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            background-color: #fff;
        }

        /* --- ë²„íŠ¼ --- */
        .submit-btn {
            background: linear-gradient(to right, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 25px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 154, 158, 0.6);
        }
        .submit-btn:disabled {
            background: #ddd;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* --- ê¸°ëŠ¥ 3: ê²°ê³¼ í™”ë©´ (í¸ì§€ì§€ ëŠë‚Œ) --- */
        .result-section {
            margin-top: 30px;
            display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
            animation: fadeIn 0.8s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .letter-card {
            background-color: #fffdf9;
            border: 1px dashed #d1d1d1;
            padding: 25px;
            border-radius: 10px;
            position: relative;
            text-align: left;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.02);
        }

        .letter-content {
            font-family: 'Nanum Pen Script', cursive; /* ì†ê¸€ì”¨ í°íŠ¸ */
            font-size: 1.6rem;
            line-height: 1.6;
            color: #555;
            white-space: pre-wrap;
        }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loader {
            display: none;
            margin: 20px auto;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            margin-top: 30px;
            font-size: 0.7rem;
            color: #aaa;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ì˜¤ëŠ˜ í•˜ë£¨, ì–´ë• ë‚˜ìš”?</h1>
        <p class="subtitle">ë‹¹ì‹ ì˜ ë§ˆìŒì„ ë“¤ë ¤ì£¼ì„¸ìš”. ë”°ëœ»í•˜ê²Œ ì•ˆì•„ë“œë¦´ê²Œìš”.</p>

        <div class="api-section">
            <label for="apiKey">OpenAI API Key (í…ŒìŠ¤íŠ¸ìš©):</label>
            <input type="password" id="apiKey" class="api-input" placeholder="sk-..." value="">
        </div>

        <div class="emotion-section">
            <span class="emotion-label">ì§€ê¸ˆ ê¸°ë¶„ì´ ì–´ë–¤ê°€ìš”?</span>
            <div class="emotions">
                <button class="emotion-btn" onclick="selectEmotion('í–‰ë³µí•´ìš”', this)">ğŸ¥°</button>
                <button class="emotion-btn" onclick="selectEmotion('í‰ì˜¨í•´ìš”', this)">ğŸŒ¿</button>
                <button class="emotion-btn" onclick="selectEmotion('ìŠ¬í¼ìš”', this)">ğŸ’§</button>
                <button class="emotion-btn" onclick="selectEmotion('í™”ë‚˜ìš”', this)">ğŸ”¥</button>
                <button class="emotion-btn" onclick="selectEmotion('ì§€ì³ìš”', this)">â˜ï¸</button>
            </div>
        </div>

        <div class="input-section">
            <textarea id="userText" placeholder="ì˜¤ëŠ˜ ìˆì—ˆë˜ ì¼ì´ë‚˜ ì§€ê¸ˆ ë“œëŠ” ìƒê°ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”..."></textarea>
        </div>

        <button class="submit-btn" id="submitBtn" onclick="generateMessage()">ë§ˆìŒ ì „ì†¡í•˜ê¸°</button>
        
        <div class="loader" id="loader"></div>

        <div class="result-section" id="resultSection">
            <div class="letter-card">
                <div class="letter-content" id="aiResponse">
                    </div>
            </div>
        </div>

        <div class="footer">
            Powered by OpenAI GPT
        </div>
    </div>

    <script>
        let selectedMood = '';

        // ê°ì • ì„ íƒ í•¨ìˆ˜
        function selectEmotion(mood, element) {
            selectedMood = mood;
            
            // ëª¨ë“  ë²„íŠ¼ ì´ˆê¸°í™”
            const buttons = document.querySelectorAll('.emotion-btn');
            buttons.forEach(btn => btn.classList.remove('selected'));
            
            // ì„ íƒëœ ë²„íŠ¼ í™œì„±í™”
            element.classList.add('selected');
        }

        // GPT í˜¸ì¶œ ë° ë©”ì‹œì§€ ìƒì„± í•¨ìˆ˜
        async function generateMessage() {
            const apiKey = document.getElementById('apiKey').value;
            const userText = document.getElementById('userText').value;
            const resultSection = document.getElementById('resultSection');
            const aiResponse = document.getElementById('aiResponse');
            const loader = document.getElementById('loader');
            const submitBtn = document.getElementById('submitBtn');

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!apiKey) {
                alert('API Keyë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            if (!selectedMood) {
                alert('ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            if (!userText.trim()) {
                alert('ì˜¤ëŠ˜ì˜ í•˜ë£¨ë¥¼ í•œë§ˆë”” ì ì–´ì£¼ì„¸ìš”.');
                return;
            }

            // UI ìƒíƒœ ë³€ê²½ (ë¡œë”© ì¤‘)
            submitBtn.disabled = true;
            submitBtn.innerText = "ë§ˆìŒì„ ì½ê³  ìˆì–´ìš”...";
            resultSection.style.display = 'none';
            loader.style.display = 'block';

            // í”„ë¡¬í”„íŠ¸ êµ¬ì„±
            const prompt = `
                ì—­í• : ë‹¹ì‹ ì€ ë”°ëœ»í•˜ê³  ì‚¬ë ¤ ê¹Šì€ ì„ ìƒë‹˜ì´ì ìƒë‹´ê°€ì…ë‹ˆë‹¤.
                ìƒí™©: í•™ìƒì´ ìì‹ ì˜ í•˜ë£¨ì™€ ê°ì •ì„ ì´ì•¼ê¸°í–ˆìŠµë‹ˆë‹¤.
                í•™ìƒì˜ ê°ì •: ${selectedMood}
                í•™ìƒì˜ í•˜ë£¨ ë‚´ìš©: "${userText}"
                
                ìš”ì²­ì‚¬í•­: 
                1. í•™ìƒì˜ ê°ì •ì— ê¹Šì´ ê³µê°í•´ì£¼ì„¸ìš”.
                2. í•™ìƒì´ ì ì€ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ë”°ëœ»í•˜ê³  ì‹œì ì¸ ìœ„ë¡œì™€ ê²©ë ¤ì˜ ë§ì„ ê±´ë„¤ì£¼ì„¸ìš”.
                3. ë„ˆë¬´ ê°€ë¥´ì¹˜ë ¤ í•˜ì§€ ë§ê³ , ì˜†ì—ì„œ ë‹¤ë…ì—¬ì£¼ëŠ” ë§íˆ¬(í•´ìš”ì²´)ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
                4. ë‹µë³€ ê¸¸ì´ëŠ” 3~4ë¬¸ì¥ìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.
                5. í•œêµ­ì–´ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.
            `;

            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: "gpt-3.5-turbo", // ë˜ëŠ” gpt-4o-mini
                        messages: [{ role: "user", content: prompt }],
                        temperature: 0.7,
                        max_tokens: 300
                    })
                });

                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error.message);
                }

                // ê²°ê³¼ í‘œì‹œ
                const message = data.choices[0].message.content;
                aiResponse.innerText = message;
                resultSection.style.display = 'block';

            } catch (error) {
                console.error('Error:', error);
                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            } finally {
                // UI ë³µêµ¬
                submitBtn.disabled = false;
                submitBtn.innerText = "ë§ˆìŒ ì „ì†¡í•˜ê¸°";
                loader.style.display = 'none';
            }
        }
    </script>
</body>
</html>
